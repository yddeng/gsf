
### 实现一个排名服

计算排名：排行榜中玩家数据一旦被更新，重新计算排名。
获取 top 数据：获取在当前排行榜中排名前 N 个的玩家数据。
获取当前玩家的排名：即使当前玩家没有名列前茅，也可以获取他在排行中的具体名次，以此了解到当前玩家和前排玩家的差距。
获取当前玩家附近排名的玩家：例如为当前玩家寻找水平相当的对手或好友。
数据重置：支持自动定期重置或手动重置数据，比如在一个赛季结束之时或在指定天、周、月后自动重置排行榜，或是在应用测试阶段、应用数据出现误差的情况下进行手动重置。

更新模式：提供两种分数更新模式，better 保留玩家的最好成绩，last 保留玩家的最新成绩。

### 思路

1、全服排名 也有不同的情况的，看是不是每个人都要知道自己的具体名次
2、全服排名 跟 同时在线人数没有什么必然的联系，应该是跟数据库里面总的玩家记录数有关

比如有的游戏是只有top100才显示具体名次，100名之后的只提示 您超过了 XX% 的玩家

如果所有人都要给具体名次的话，就比较蛋疼一点，做一个 玩家id <-> 排名  的双向映射表，开服load一遍数据库，把这个表初始化好，然后当要排名的那个数值变动的时候， 增加则向前搜超过了哪些人，逐个交换名次；减少则向后搜落后于哪些人，逐个交换名次

另外一种替代方案是，比如我有100W玩家，我就固定有100w个名次，刚开服一开始都是机器人，就是让玩家自己pvp去打排名（而不是服务器主动排名），你能赢了前一个人，你就和前一个人的名次交换，你能直接赢第一名，你就和第一名进行名次交换，被交换下去的玩家，自己去重新打排名

如果不是每个玩家都要给具体名次，比如只需要top100，就好办一点，前100个人，就事实排就好， 新来一个人，就判断能不能进前100，能进，再计算具体名次；
不能进，就是100名之后的。
然后对于所有100名之后的玩家，按数值区间建立若干个桶，比如我们预计要排名的那一个数据的最大值能到1W。我建立0-10， 10-100，100-1000， 1000-2000， 2000-5000， 5000-10000 这样6个桶，每个桶里面记录分值在这个桶对应的区间内，有多少个玩家。 比如
0-10， 10人
10-100，20人
100-1000，30人
1000-2000， 40人
2000-5000， 50人
5000-10000， 60人
那么如果一个玩家 是 1234分，那么他的排名就超过了 （10 + 20 + 30）/ （10 + 20 + 30 + 40 + 50 + 60）这个百分比的玩家（所以桶分的越细，后面的排名越精确）